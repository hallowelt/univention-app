<VirtualHost *:80>

	DocumentRoot /var/www/bluespice

	RewriteEngine On
	RewriteRule ^/?wiki(/.*)?$ %{DOCUMENT_ROOT}/w/index.php [L]

	<Directory /var/www/bluespice>
		Options FollowSymLinks MultiViews
		AllowOverride None
		Require all granted
	</Directory>

	<Directory /var/www/bluespice/w/images>
		AllowOverride None
		AddType text/plain .html .htm .shtml .phtml .php .php3 .php4 .php5 .php7
		php_admin_flag engine off
		Require all denied
	</Directory>

	<Directory /var/www/bluespice/w/cache>
		Require all denied
	</Directory>

	<Directory /var/www/bluespice/w/.git>
		Require all denied
	</Directory>

	ErrorLog ${APACHE_LOG_DIR}/error-bluespice.log
	LogLevel warn
	CustomLog ${APACHE_LOG_DIR}/access-bluespice.log combined
	ServerSignature On

</VirtualHost>

<VirtualHost *:443>

	DocumentRoot /var/www/bluespice

	RewriteEngine On
	RewriteRule ^/?wiki(/.*)?$ %{DOCUMENT_ROOT}/w/index.php [L]

	<Directory /var/www/bluespice/w>
		Options FollowSymLinks MultiViews
		AllowOverride None
		Require all granted
	</Directory>

	<Directory /var/www/bluespice/w/images>
		AllowOverride None
		AddType text/plain .html .htm .shtml .phtml .php .php3 .php4 .php5 .php7
		php_admin_flag engine off
		Require all denied
	</Directory>

	<Directory /var/www/bluespice/w/cache>
		Require all denied
	</Directory>

	<Directory /var/www/bluespice/w/.git>
		Require all denied
	</Directory>

	SSLEngine on
	SSLCertificateFile /opt/ca/httpd.crt
	SSLCertificateKeyFile /opt/ca/httpd.key

	ErrorLog ${APACHE_LOG_DIR}/error-bluespice-ssl.log
	LogLevel warn
	CustomLog ${APACHE_LOG_DIR}/access-bluespice-ssl.log combined
	ServerSignature On

</VirtualHost>

